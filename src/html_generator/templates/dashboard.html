{% extends "base.html" %}

{% block content %}
<div class="stats-grid">
    <a href="seo-analysis.html" class="stat-card clickable-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.seo.summary.total_issues or 0 }}</div>
                <div class="stat-label">SEO Issues Found</div>
                <div class="card-description">Search engine optimization analysis with title tags, meta descriptions, and content structure</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <i class="fas fa-search"></i>
            </div>
        </div>
    </a>

    <a href="accessibility.html" class="stat-card clickable-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.accessibility.summary.score or 0 }}%</div>
                <div class="stat-label">Accessibility Score</div>
                <div class="card-description">WCAG 2.1 AA compliance analysis with {{ data.accessibility.summary.total_issues or 0 }} issues identified</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                <i class="fas fa-universal-access"></i>
            </div>
        </div>
    </a>

    <a href="qa-tests.html" class="stat-card clickable-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.qa_tests.summary.total_assertions or 0 }}</div>
                <div class="stat-label">QA Test Cases</div>
                <div class="card-description">{{ data.qa_tests.summary.total_assertions or 0 }} test assertions across {{ data.qa_tests.summary.total_test_files or 0 }} test files</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <i class="fas fa-tasks"></i>
            </div>
        </div>
    </a>

    <a href="ux-analysis.html" class="stat-card clickable-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.ux.summary.total_recommendations or 0 }}</div>
                <div class="stat-label">UX Recommendations</div>
                <div class="card-description">User experience analysis with {{ data.ux.summary.high_priority or 0 }} high-priority improvements</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                <i class="fas fa-user-check"></i>
            </div>
        </div>
    </a>

    <a href="screenshots.html" class="stat-card clickable-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.screenshots|length or 0 }}</div>
                <div class="stat-label">Screenshots Captured</div>
                <div class="card-description">Visual gallery of all {{ data.overview.total_pages or 0 }} pages captured during website analysis</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                <i class="fas fa-images"></i>
            </div>
        </div>
    </a>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.overview.total_pages or 0 }}</div>
                <div class="stat-label">Pages Analyzed</div>
                <div class="card-description">Total pages crawled and analyzed for comprehensive website assessment</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <i class="fas fa-globe"></i>
            </div>
        </div>
    </div>
</div>


<!-- Site Structure Section -->
<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-sitemap"></i>
        Website Structure & Site Map
    </h2>
    <div class="section-description">
        Visual representation of the website structure showing page relationships and internal linking structure.
    </div>
    <div class="sitemap-container">
        <div class="sitemap-help">
            Click and drag to pan â€¢ Mouse wheel to zoom
        </div>
        <div id="sitemap-wrapper" class="sitemap-wrapper">
            <div id="sitemap-svg" class="sitemap-image">
                <!-- SVG content will be loaded here -->
            </div>
        </div>
    </div>
    
    <script>
        let currentScale = 1;
        let currentX = 0;
        let currentY = 0;
        let isDragging = false;
        let dragStart = { x: 0, y: 0 };
        
        const wrapper = document.getElementById('sitemap-wrapper');
        const sitemapContainer = document.getElementById('sitemap-svg');
        
        // Load SVG content directly
        fetch('assets/sitemap.svg')
            .then(response => response.text())
            .then(svgText => {
                sitemapContainer.innerHTML = svgText;
                const svgElement = sitemapContainer.querySelector('svg');
                if (svgElement) {
                    svgElement.style.width = '100%';
                    svgElement.style.height = '100%';
                }
            })
            .catch(error => {
                sitemapContainer.innerHTML = '<p>Unable to load sitemap</p>';
            });
        
        function updateTransform() {
            const svgElement = sitemapContainer.querySelector('svg');
            if (svgElement) {
                svgElement.style.transform = `scale(${currentScale}) translate(${currentX/currentScale}px, ${currentY/currentScale}px)`;
            }
        }
        
        // Mouse wheel zoom
        wrapper.addEventListener('wheel', (e) => {
            e.preventDefault();
            const rect = wrapper.getBoundingClientRect();
            const centerX = rect.width / 2;
            const centerY = rect.height / 2;
            
            const zoomFactor = e.deltaY > 0 ? 0.9 : 1.1;
            const newScale = currentScale * zoomFactor;
            
            // Zoom towards mouse position
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;
            
            currentX += (mouseX - centerX) * (1 - zoomFactor);
            currentY += (mouseY - centerY) * (1 - zoomFactor);
            currentScale = newScale;
            
            updateTransform();
        });
        
        // Pan with mouse drag
        wrapper.addEventListener('mousedown', (e) => {
            isDragging = true;
            dragStart.x = e.clientX - currentX;
            dragStart.y = e.clientY - currentY;
            wrapper.style.cursor = 'grabbing';
            e.preventDefault();
        });
        
        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                currentX = e.clientX - dragStart.x;
                currentY = e.clientY - dragStart.y;
                updateTransform();
            }
        });
        
        document.addEventListener('mouseup', () => {
            isDragging = false;
            wrapper.style.cursor = 'grab';
        });
    </script>
</div>

{% endblock %}