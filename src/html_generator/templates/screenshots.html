{% extends "base.html" %}

{% block title %}Screenshots Gallery - {{ site_title }}{% endblock %}

{% block header_description %}Visual gallery of all website pages captured during analysis{% endblock %}

{% block content %}
<!-- Screenshots Summary -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.screenshots|length or 0 }}</div>
                <div class="stat-label">Screenshots</div>
                <div class="card-description">Total page screenshots captured</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <i class="fas fa-images"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.overview.total_pages or 0 }}</div>
                <div class="stat-label">Pages Analyzed</div>
                <div class="card-description">Total pages crawled and captured</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                <i class="fas fa-globe"></i>
            </div>
        </div>
    </div>
</div>

<!-- Screenshots Gallery -->
{% if data.screenshots %}
<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-images"></i>
        Page Screenshots Gallery
    </h2>
    <div class="section-description">
        Visual representations of all pages captured during the website analysis. Click on any screenshot to view it in full size.
    </div>
    
    <div class="screenshots-grid">
        {% for screenshot in data.screenshots %}
        <div class="screenshot-card">
            <div class="screenshot-title">
                <i class="fas fa-file-alt"></i>
                {{ screenshot.title }}
            </div>
            <div class="screenshot-url">{{ screenshot.url or screenshot.filename }}</div>
            <img src="{{ screenshot.path }}" 
                 alt="Screenshot of {{ screenshot.title }}" 
                 class="screenshot-image"
                 onclick="openLightbox('{{ screenshot.path }}', '{{ screenshot.title }}')">
        </div>
        {% endfor %}
    </div>
</div>
{% else %}
<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-images"></i>
        No Screenshots Available
    </h2>
    <div class="section-description">
        No screenshots were found in the analysis data. Screenshots are typically captured during the website crawling process.
    </div>
    
    <div style="text-align: center; padding: 2rem; background: #f7fafc; border-radius: 12px; margin-top: 1rem;">
        <i class="fas fa-camera" style="font-size: 3rem; color: #cbd5e0; margin-bottom: 1rem;"></i>
        <p style="color: #4a5568; margin-bottom: 1rem;">Screenshots will appear here after running a full website analysis.</p>
        <p style="color: #718096; font-size: 0.9rem;">Run the crawler with screenshot capture enabled to populate this gallery.</p>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_head %}
<style>
/* Screenshots-specific styles */
.screenshots-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 2rem;
    margin-top: 2rem;
}

.screenshot-card {
    background: white;
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.screenshot-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 48px rgba(0,0,0,0.15);
}

.screenshot-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #2d3748;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.screenshot-url {
    font-size: 0.9rem;
    color: #667eea;
    margin-bottom: 1rem;
    word-break: break-all;
}

.screenshot-image {
    width: 100%;
    height: auto;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
    cursor: pointer;
    transition: transform 0.3s ease;
}

.screenshot-image:hover {
    transform: scale(1.02);
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .screenshots-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<!-- Enhanced Lightbox for full-size screenshot viewing -->
<div id="lightbox" class="lightbox">
    <button class="lightbox-close" onclick="closeLightbox()">
        <i class="fas fa-times"></i>
    </button>
    <img id="lightbox-image" class="lightbox-content" alt="Full size screenshot">
    <div id="lightbox-title" class="lightbox-title"></div>
</div>

<script>
// Enhanced lightbox functionality
function openLightbox(imageSrc, title) {
    const lightbox = document.getElementById('lightbox');
    const lightboxImage = document.getElementById('lightbox-image');
    const lightboxTitle = document.getElementById('lightbox-title');
    
    lightboxImage.src = imageSrc;
    lightboxTitle.textContent = title || '';
    lightbox.classList.add('active');
    
    // Prevent body scroll when lightbox is open
    document.body.style.overflow = 'hidden';
}

function closeLightbox() {
    const lightbox = document.getElementById('lightbox');
    lightbox.classList.remove('active');
    
    // Restore body scroll
    document.body.style.overflow = 'auto';
}

// Close lightbox on Escape key
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeLightbox();
    }
});

// Prevent lightbox from closing when clicking on the image
document.addEventListener('DOMContentLoaded', function() {
    const lightboxImage = document.getElementById('lightbox-image');
    if (lightboxImage) {
        lightboxImage.addEventListener('click', function(event) {
            event.stopPropagation();
        });
    }
});
</script>

<style>
/* Enhanced lightbox styles */
.lightbox-title {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    color: white;
    background: rgba(0,0,0,0.7);
    padding: 1rem 2rem;
    border-radius: 8px;
    text-align: center;
    font-weight: 600;
}

@media (max-width: 768px) {
    .lightbox-title {
        bottom: 20px;
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
    }
}
</style>
{% endblock %}