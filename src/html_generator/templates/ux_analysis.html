{% extends "base.html" %}

{% block title %}UX Analysis - {{ site_title }}{% endblock %}

{% block header_description %}User experience analysis with actionable recommendations for improved usability{% endblock %}

{% block content %}
<!-- UX Summary Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.ux.summary.total_issues or 0 }}</div>
                <div class="stat-label">UX Issues</div>
                <div class="card-description">User experience issues identified</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.ux.summary.total_recommendations or 0 }}</div>
                <div class="stat-label">Recommendations</div>
                <div class="card-description">Actionable improvement suggestions</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                <i class="fas fa-lightbulb"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.ux.summary.high_priority or 0 }}</div>
                <div class="stat-label">High Priority</div>
                <div class="card-description">Critical improvements for immediate attention</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <i class="fas fa-flag"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.ux.summary.medium_priority + data.ux.summary.low_priority or 0 }}</div>
                <div class="stat-label">Lower Priority</div>
                <div class="card-description">Medium and low priority enhancements</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                <i class="fas fa-list"></i>
            </div>
        </div>
    </div>
</div>

<!-- Priority Breakdown -->
<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-chart-pie"></i>
        Recommendation Priority Breakdown
    </h2>
    <div class="metrics-grid">
        <div class="metric-item">
            <div class="metric-value" style="color: #e53e3e;">{{ data.ux.summary.high_priority or 0 }}</div>
            <div class="metric-label">High Priority</div>
        </div>
        <div class="metric-item">
            <div class="metric-value" style="color: #dd6b20;">{{ data.ux.summary.medium_priority or 0 }}</div>
            <div class="metric-label">Medium Priority</div>
        </div>
        <div class="metric-item">
            <div class="metric-value" style="color: #38a169;">{{ data.ux.summary.low_priority or 0 }}</div>
            <div class="metric-label">Low Priority</div>
        </div>
        <div class="metric-item">
            <div class="metric-value">{{ (((data.ux.summary.high_priority or 0) / ([data.ux.summary.total_recommendations, 1] | max) * 100)|round) if data.ux.summary.total_recommendations else 0 }}%</div>
            <div class="metric-label">Critical Focus</div>
        </div>
    </div>
</div>

<!-- UX Issues -->
{% if data.ux.issues %}
<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-bug"></i>
        User Experience Issues
    </h2>
    <div class="section-description">
        Issues that may negatively impact user experience and require attention.
    </div>
    
    {% for issue in data.ux.issues %}
    <div class="issue-item">
        <i class="fas fa-times-circle issue-icon"></i>
        <div class="issue-content">
            <h4>UX Issue</h4>
            <div class="issue-description">{{ issue.text if issue.text is defined else issue }}</div>
            {% if issue.page_url %}
            <div style="margin-top: 0.5rem; padding: 0.5rem; background: #fed7d7; border-radius: 6px; border-left: 3px solid #e53e3e;">
                <strong style="color: #742a2a;">Page:</strong> 
                <code style="background: rgba(0,0,0,0.1); padding: 2px 4px; border-radius: 3px; font-size: 0.85rem;">{{ issue.page_url }}</code>
            </div>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- UX Recommendations -->
{% if data.ux.recommendations %}
<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-lightbulb"></i>
        UX Recommendations
    </h2>
    <div class="section-description">
        Actionable recommendations to improve user experience.
    </div>
    
    <!-- High Priority Recommendations -->
    {% set high_recs = data.ux.recommendations | selectattr("priority", "equalto", "high") | list %}
    {% if high_recs %}
    <div style="margin-bottom: 2rem;">
        <h3 style="color: #e53e3e; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-exclamation-circle"></i> High Priority ({{ high_recs|length }})
        </h3>
        {% for recommendation in high_recs %}
        <div class="issue-item severity-high">
            <i class="fas fa-exclamation-circle issue-icon" style="color: #e53e3e;"></i>
            <div class="issue-content">
                <h4>High Priority Recommendation <span class="status-badge priority-high">High</span></h4>
                <div class="issue-description">{{ recommendation.text }}</div>
                {% if recommendation.page_url %}
                <div style="margin-top: 0.5rem; padding: 0.5rem; background: #fed7d7; border-radius: 6px; border-left: 3px solid #e53e3e;">
                    <strong style="color: #742a2a;">Page:</strong> 
                    <code style="background: rgba(0,0,0,0.1); padding: 2px 4px; border-radius: 3px; font-size: 0.85rem;">{{ recommendation.page_url }}</code>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <!-- Medium Priority Recommendations -->
    {% set medium_recs = data.ux.recommendations | selectattr("priority", "equalto", "medium") | list %}
    {% if medium_recs %}
    <div style="margin-bottom: 2rem;">
        <h3 style="color: #dd6b20; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-exclamation-triangle"></i> Medium Priority ({{ medium_recs|length }})
        </h3>
        {% for recommendation in medium_recs %}
        <div class="issue-item severity-medium">
            <i class="fas fa-exclamation-triangle issue-icon" style="color: #dd6b20;"></i>
            <div class="issue-content">
                <h4>Medium Priority Recommendation <span class="status-badge priority-medium">Medium</span></h4>
                <div class="issue-description">{{ recommendation.text }}</div>
                {% if recommendation.page_url %}
                <div style="margin-top: 0.5rem; padding: 0.5rem; background: #feebc8; border-radius: 6px; border-left: 3px solid #dd6b20;">
                    <strong style="color: #744210;">Page:</strong> 
                    <code style="background: rgba(0,0,0,0.1); padding: 2px 4px; border-radius: 3px; font-size: 0.85rem;">{{ recommendation.page_url }}</code>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <!-- Low Priority Recommendations -->
    {% set low_recs = data.ux.recommendations | selectattr("priority", "equalto", "low") | list %}
    {% if low_recs %}
    <div style="margin-bottom: 2rem;">
        <h3 style="color: #38a169; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-info-circle"></i> Low Priority ({{ low_recs|length }})
        </h3>
        {% for recommendation in low_recs %}
        <div class="issue-item severity-low">
            <i class="fas fa-info-circle issue-icon" style="color: #38a169;"></i>
            <div class="issue-content">
                <h4>Low Priority Recommendation <span class="status-badge priority-low">Low</span></h4>
                <div class="issue-description">{{ recommendation.text }}</div>
                {% if recommendation.page_url %}
                <div style="margin-top: 0.5rem; padding: 0.5rem; background: #c6f6d5; border-radius: 6px; border-left: 3px solid #38a169;">
                    <strong style="color: #22543d;">Page:</strong> 
                    <code style="background: rgba(0,0,0,0.1); padding: 2px 4px; border-radius: 3px; font-size: 0.85rem;">{{ recommendation.page_url }}</code>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>
{% endif %}

{% endblock %}