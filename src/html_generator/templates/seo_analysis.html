{% extends "base.html" %}

{% block title %}SEO Analysis - {{ site_title }}{% endblock %}

{% block header_description %}Search engine optimization analysis with detailed insights and recommendations{% endblock %}

{% block content %}
<!-- SEO Summary Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.seo.summary.total_pages or 0 }}</div>
                <div class="stat-label">Pages Analyzed</div>
                <div class="card-description">Total pages included in SEO analysis</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <i class="fas fa-globe"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.seo.summary.total_issues or 0 }}</div>
                <div class="stat-label">Issues Found</div>
                <div class="card-description">SEO issues requiring attention</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.seo.summary.avg_title_length or 0 }}</div>
                <div class="stat-label">Avg Title Length</div>
                <div class="card-description">Characters in title tags (optimal: 30-60)</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <i class="fas fa-heading"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div>
                <div class="stat-value">{{ data.seo.summary.avg_desc_length or 0 }}</div>
                <div class="stat-label">Avg Description Length</div>
                <div class="card-description">Characters in meta descriptions (optimal: 120-160)</div>
            </div>
            <div class="stat-icon" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                <i class="fas fa-align-left"></i>
            </div>
        </div>
    </div>
</div>

<!-- Page Analysis -->
{% if data.seo.pages %}
<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-search"></i>
        Page-by-Page SEO Analysis
    </h2>
    
    {% for page in data.seo.pages %}
    <div class="test-phase">
        <div class="phase-header" onclick="toggleSection(this)">
            <div class="phase-title">
                {{ page.url }} - Score: {{ page.score }}%
            </div>
            <i class="fas fa-chevron-down toggle-icon"></i>
        </div>
        <div class="phase-content" style="display: none;">
            <!-- Page Details -->
            <div style="margin-bottom: 1.5rem;">
                <h4 style="color: #2d3748; margin-bottom: 0.5rem;">Page Information</h4>
                <table class="data-table">
                    <tr>
                        <td><strong>Title Tag</strong></td>
                        <td>{{ page.title or 'Not found' }} 
                            {% if page.title %}({{ page.title|length }} chars){% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Meta Description</strong></td>
                        <td>{{ page.description or 'Not found' }} 
                            {% if page.description %}({{ page.description|length }} chars){% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td><strong>H1 Tag</strong></td>
                        <td>{{ page.h1 or 'Not found' }}</td>
                    </tr>
                    <tr>
                        <td><strong>H2 Elements</strong></td>
                        <td>{{ page.h2_count }} found</td>
                    </tr>
                </table>
            </div>

            <!-- Issues -->
            {% if page.issues %}
            <div style="margin-bottom: 1.5rem;">
                <h4 style="color: #e53e3e; margin-bottom: 0.5rem;">Issues Found</h4>
                <ul class="issue-list">
                    {% for issue in page.issues %}
                    <li class="issue-item">
                        <i class="fas fa-exclamation-circle issue-icon"></i>
                        <div class="issue-content">
                            <div class="issue-description">{{ issue }}</div>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            <!-- Recommendations -->
            {% if page.recommendations %}
            <div style="margin-bottom: 1.5rem;">
                <h4 style="color: #38a169; margin-bottom: 0.5rem;">Recommendations</h4>
                <ul class="issue-list">
                    {% for recommendation in page.recommendations %}
                    <li class="issue-item severity-low">
                        <i class="fas fa-lightbulb issue-icon" style="color: #38a169;"></i>
                        <div class="issue-content">
                            <div class="issue-description">{{ recommendation }}</div>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            <!-- H2 Elements -->
            {% if page.h2_elements %}
            <div>
                <h4 style="color: #2d3748; margin-bottom: 0.5rem;">H2 Elements ({{ page.h2_count }} found)</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">
                    {% for h2 in page.h2_elements %}
                    <div style="background: #f7fafc; padding: 0.5rem; border-radius: 4px; font-size: 0.9rem;">
                        {{ h2 or 'Empty H2' }}
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- SEO Best Practices -->
<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-star"></i>
        SEO Best Practices Checklist
    </h2>
    <div class="section-description">
        Review these fundamental SEO elements for optimal search engine performance:
    </div>
    
    <div class="metrics-grid">
        <div class="metric-item">
            <div class="metric-value">
                <i class="fas fa-{% if data.seo.summary.pages_with_h1 > 0 %}check text-green-600{% else %}times text-red-600{% endif %}"></i>
            </div>
            <div class="metric-label">H1 Tags Present</div>
        </div>
        <div class="metric-item">
            <div class="metric-value">{{ data.seo.summary.total_h2_elements or 0 }}</div>
            <div class="metric-label">H2 Elements</div>
        </div>
        <div class="metric-item">
            <div class="metric-value">30-60</div>
            <div class="metric-label">Optimal Title Length</div>
        </div>
        <div class="metric-item">
            <div class="metric-value">120-160</div>
            <div class="metric-label">Optimal Description Length</div>
        </div>
    </div>
    
    <div style="margin-top: 2rem;">
        <h3 style="color: #2d3748; margin-bottom: 1rem;">Key Recommendations</h3>
        <ul style="list-style-type: disc; padding-left: 1.5rem; color: #4a5568; line-height: 1.6;">
            <li>Ensure all pages have unique, descriptive title tags between 30-60 characters</li>
            <li>Write compelling meta descriptions that accurately describe page content (120-160 chars)</li>
            <li>Use proper heading hierarchy with one H1 per page and logical H2-H6 structure</li>
            <li>Include target keywords naturally in titles, descriptions, and headings</li>
            <li>Ensure fast page loading speeds and mobile-friendly design</li>
            <li>Create high-quality, original content that provides value to users</li>
        </ul>
    </div>
</div>
{% endblock %}